<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>X Nonrectangular Window Shape Extension Protocol</title><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /></head><body><div class="book" title="X Nonrectangular Window Shape Extension Protocol"><div class="titlepage"><div><div><h1 class="title"><a id="shape"></a>X Nonrectangular Window Shape Extension Protocol</h1></div><div><h2 class="subtitle">X.Org Standard</h2></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Keith</span> <span class="surname">Packard</span></h3><div class="affiliation"><span class="orgname">MIT X Consortium Intel Corporation<br /></span></div></div><div class="othercredit"><h3 class="othercredit"><span class="firstname">Hideki</span> <span class="surname">Hiura</span></h3><div class="affiliation"><span class="orgname">SunSoft, Inc.<br /></span></div></div></div></div><div><p class="releaseinfo">Version 1.1</p></div><div><p class="copyright">Copyright © 1989 The Open Group</p></div><div><p class="copyright">Copyright © 2004 The Open Group</p></div><div><p class="copyright">Copyright © 2006 Keith Packard</p></div><div><div class="legalnotice" title="Legal Notice"><a id="idp17350680"></a><p>
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
</p><p>
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
</p><p>
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN
AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</p><p>
Except as contained in this notice, the name of the copyright holders
shall not be
used in advertising or otherwise to promote the sale, use or other dealings
in this Software without prior written authorization from the
copyright holders.
</p></div></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#Overview">1. Overview</a></span></dt><dt><span class="chapter"><a href="#Description">2. Description</a></span></dt><dt><span class="chapter"><a href="#Types">3. Types</a></span></dt><dt><span class="chapter"><a href="#Requests">4. Requests</a></span></dt><dt><span class="chapter"><a href="#Events">5. Events</a></span></dt><dt><span class="chapter"><a href="#Encoding">6. Encoding</a></span></dt><dd><dl><dt><span class="sect1"><a href="#New_Types">New Types</a></span></dt><dt><span class="sect1"><a href="#Requests_2">Requests</a></span></dt><dt><span class="sect1"><a href="#Events_2">Events</a></span></dt></dl></dd><dt><span class="glossary"><a href="#glossary">Glossary</a></span></dt></dl></div><div class="chapter" title="Chapter 1. Overview"><div class="titlepage"><div><div><h2 class="title"><a id="Overview"></a>Chapter 1. Overview</h2></div></div></div><p>

This extension provides arbitrary window and border shapes within the X11
protocol.
</p><p>

The restriction of rectangular windows within the X protocol is a significant
limitation in the implementation of many styles of user interface.  For
example, many transient windows would like to display a "drop shadow'' to
give the illusion of 3 dimensions.  As another example, some user interface
style guides call for buttons with rounded corners; the full simulation of a
nonrectangular shape, particularly with respect to event distribution and
cursor shape, is not possible within the core X protocol.  As a final
example, round clocks and nonrectangular icons are desirable visual addition
to the desktop.
</p><p>

This extension provides mechanisms for changing both the visible and interactive shape of a
window to arbitrary, possibly disjoint, nonrectangular forms.  The intent
of the extension is to supplement the existing semantics, not replace them.
In particular, it is desirable for clients that are unaware of the
extension to still be able to cope reasonably with shaped windows.  For
example, window managers should still be able to negotiate screen
real estate in rectangular pieces.  Toward this end, any shape specified for
a window is clipped by the bounding rectangle for the window as specified by
the window's geometry in the core protocol.  An expected convention would be
that client programs expand their shape to fill the area offered by the
window manager.
</p></div><div class="chapter" title="Chapter 2. Description"><div class="titlepage"><div><div><h2 class="title"><a id="Description"></a>Chapter 2. Description</h2></div></div></div><p>
Each window (even with no shapes specified) is defined by three regions:  the
<span class="emphasis"><em>bounding region</em></span>, the <span class="emphasis"><em>clip
region</em></span> and the <span class="emphasis"><em>input region</em></span>.  The
bounding region is the area of the
parent window that the window will occupy (including border). The clip region
is the subset of the bounding region that is available for subwindows and
graphics.  The area between the bounding region and the clip region is defined
to be the border of the window. The input region is the subset of the
bounding region that can "contain" the pointer.
</p><p>
A nonshaped window will have a bounding region that is a rectangle
spanning the window, including its border; the clip region will be a rectangle
filling the inside dimensions (not including the border); the input
region will match the bounding region.  In this document,
these areas are referred to as the
<span class="emphasis"><em>default bounding region</em></span>, the
<span class="emphasis"><em>default clip region</em></span> and the
<span class="emphasis"><em>default input region</em></span>.  For a window with inside
size of <span class="emphasis"><em>width</em></span> by
<span class="emphasis"><em>height</em></span> and border width
<span class="emphasis"><em>bwidth</em></span>, the default bounding, clip
and input regions are the rectangles (relative to the window origin):
</p><pre class="literallayout">
bounding.x = -<span class="emphasis"><em>bwidth</em></span>
bounding.y = -<span class="emphasis"><em>bwidth</em></span>
bounding.width = <span class="emphasis"><em>width</em></span> + 2 * <span class="emphasis"><em>bwidth</em></span>
bounding.height = <span class="emphasis"><em>height</em></span> + 2 * <span class="emphasis"><em>bwidth</em></span>

clip.x = 0
clip.y = 0
clip.width = <span class="emphasis"><em>width</em></span>
clip.height = <span class="emphasis"><em>height</em></span>

input.x = -<span class="emphasis"><em>bwidth</em></span>
input.y = -<span class="emphasis"><em>bwidth</em></span>
input.width = <span class="emphasis"><em>width</em></span> + 2 * <span class="emphasis"><em>bwidth</em></span>
input.height = <span class="emphasis"><em>height</em></span> + 2 * <span class="emphasis"><em>bwidth</em></span>
</pre><p>
This extension allows a client to modify any combination of the bounding,
clip or input regions by specifying new regions that combine with the default
regions.  These new regions are called the
<span class="emphasis"><em>client bounding region</em></span>,
the <span class="emphasis"><em>client clip region</em></span> and the
<span class="emphasis"><em>client input region</em></span>.  They are specified
relative to the origin of
the window and are always defined by offsets relative to the window origin
(that is, region adjustments are not required when the window is moved).
Three mechanisms for specifying regions are provided:  a list of rectangles,
a bitmap, and an existing bounding or clip region from a window.  This is
modeled on the specification of regions in graphics contexts in the core
protocol and allows a variety of different uses of the extension.
</p><p>
When using an existing window shape as an operand in specifying a new shape,
the client region is used, unless none has been set, in which case the
default region is used instead.
</p><p>
The <span class="emphasis"><em>effective bounding region</em></span> of a window
is defined to be the intersection of
the client bounding region with the default bounding region.  Any portion of
the client bounding region that is not included in the default bounding
region will not be included in the effective bounding region on the screen.
This means that window managers (or other geometry managers) used to dealing
with rectangular client windows will be able to constrain the client to a
rectangular area of the screen.
</p><p>
Construction of the effective bounding region is dynamic; the client bounding
region is not mutated to obtain the effective bounding region.  If a client
bounding region is specified that extends beyond the current default bounding
region, and the window is later enlarged, the effective bounding region will
be enlarged to include more of the client bounding region.
</p><p>
The <span class="emphasis"><em>effective clip region</em></span> of a window is defined to be the intersection of the
client clip region with both the default clip region and the client bounding
region.  Any portion of the client clip region that is not included in both
the default clip region and the client bounding region will not be included in
the effective clip region on the screen.
</p><p>
Construction of the effective clip region is dynamic; the client clip region is
not mutated to obtain the effective clip region.  If a client clip region is
specified that extends beyond the current default clip region and the
window or its bounding region is later enlarged, the effective clip region will
be enlarged to include more of the client clip region if it is included in
the effective bounding region.
</p><p>
The border of a window is defined to be the difference between the effective
bounding region and the effective clip region.  If this region is empty, no
border is displayed.  If this region is nonempty, the border is filled
using the border-tile or border-pixel of the window as specified in the core
protocol.  Note that a window with a nonzero border width will never be able
to draw beyond the default clip region of the window.  Also note that a zero
border width does not prevent a window from having a border, since the clip
shape can still be made smaller than the bounding shape.
</p><p>
All output to the window and visible regions of any subwindows will be
clipped to the effective clip region.  The server must not retain window
contents beyond the effective bounding region with backing store.  The window's
origin (for graphics operations, background tiling, and subwindow placement)
is not affected by the existence of a bounding region or clip region.
</p><p>
The <span class="emphasis"><em>effective input region</em></span> of a window is
defined to be the intersection of the
client input region with both the default input region and the client bounding
region.  Any portion of the client input region that is not included in both
the default input region and the client bounding region will not be included in
the effective input region on the screen.
</p><p>

Construction of the effective input region is dynamic; the client input region is
not mutated to obtain the effective input region.  If a client input region is
specified that extends beyond the current default input region and the
window or its bounding region is later enlarged, the effective input region will
be enlarged to include more of the client input region if it is included in
the effective bounding region.
</p><p>

Areas that are inside the default bounding region but outside the effective
bounding region are not part of the window; these areas of the screen will
be occupied by other windows.  Input events that occur within the default
bounding region but outside the effective bounding region will be delivered as
if the window was not occluding the event position.  Events that occur in
a nonrectangular border of a window will be delivered to that window, just
as for events that occur in a normal rectangular border.
</p><p>

An
<code class="function">InputOnly</code>
window can have its bounding or input region set, but it is a
<code class="function">Match</code>
error to attempt to set a clip region on an
<code class="function">InputOnly</code>
window or to specify its clip region as a source to a request
in this extension.
</p><p>

The server must accept changes to the clip and input regions of a root window, but
the server is permitted to ignore requested changes to the bounding region
of a root window.  If the server accepts bounding region changes, the contents
of the screen outside the bounding region are implementation dependent.
</p></div><div class="chapter" title="Chapter 3. Types"><div class="titlepage"><div><div><h2 class="title"><a id="Types"></a>Chapter 3. Types</h2></div></div></div><p>

The following types are used in the request and event definitions in
subsequent sections.
</p><p>
SHAPE_KIND:
{ <code class="function">Bounding</code>,
<code class="function">Clip</code>,
<code class="function">Input</code> }
</p><p>
SHAPE_OP:
{ <code class="function">Set</code>,
<code class="function">Union</code>,
<code class="function">Intersect</code>,
<code class="function">Subtract</code>,
<code class="function">Invert</code> }
</p><p>
<code class="function">Set</code>
indicates that the region specified as an explicit source in the request is
stored unaltered as the new destination client region.
<code class="function">Union</code>
indicates that the source and destination regions are unioned together to
produce the new destination client region.
<code class="function">Intersect</code>
indicates that the source and destination regions are intersected together to
produce the new destination client region.
<code class="function">Subtract</code>
indicates that the source region is subtracted from the destination region to
produce the new destination region.
<code class="function">Invert</code>
indicates that the destination region is subtracted from the source region to
produce the new destination region.
</p></div><div class="chapter" title="Chapter 4. Requests"><div class="titlepage"><div><div><h2 class="title"><a id="Requests"></a>Chapter 4. Requests</h2></div></div></div><p>
<code class="function">ShapeQueryVersion</code>
</p><p>
   =&gt;
</p><p>
majorVersion: CARD16
</p><p>
minorVersion: CARD16
</p><p>
This request can be used to ensure that the server version of the SHAPE
extension is usable by the client.  This document defines major version one
(1), minor version one (1).
</p><p>
<code class="function">ShapeRectangles</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left"><span class="emphasis"><em>dest</em></span>: WINDOW</td></tr><tr><td align="left"><span class="emphasis"><em>destKind</em></span>: SHAPE_KIND</td></tr><tr><td align="left"><span class="emphasis"><em>op</em></span>: SHAPE_OP</td></tr><tr><td align="left"><span class="emphasis"><em>xOff, yOff</em></span>: INT16</td></tr><tr><td align="left"><span class="emphasis"><em>rectangles</em></span>: LISTofRECTANGLES</td></tr><tr><td align="left"><span class="emphasis"><em>ordering</em></span>:
{ <code class="function">UnSorted</code>,
<code class="function">YSorted</code>,
<code class="function">YXSorted</code>,
<code class="function">YXBanded</code> }
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window</code>,
<code class="function">Length</code>,
<code class="function">Match</code>,
<code class="function">Value</code>
      </td></tr></tbody></table></div><p>
This request specifies an array of rectangles, relative to the origin of the
window plus the specified offset (xOff and yOff) that together
define a region.  This region is combined (as specified by the operator
op) with the existing client region (specified by destKind) of the
destination window, and the result is stored as the specified client region of
the destination window.  Note that the list of rectangles can be empty,
specifying an empty region; this is not the same as passing
<code class="function">None</code> to
<code class="function">ShapeMask</code>,
</p><p>
If known by the client,
ordering relations on the rectangles can be specified with the ordering
argument.
This may provide faster operation by the server.
The meanings of the ordering values are the same as in the core protocol
<code class="function">SetClipRectangles</code>
request.
If an incorrect ordering is specified,
the server may generate a
<code class="function">Match </code>
error, but it is not required to do so.
If no error is generated,
the graphics results are undefined.
Except for
<code class="function">UnSorted ,</code>
the rectangles should be nonintersecting, or the resulting region will
be undefined.
<code class="function">UnSorted </code>
means that the rectangles are in arbitrary order.
<code class="function">YSorted </code>
means that the rectangles are nondecreasing in their Y origin.
<code class="function">YXSorted </code>
additionally constrains
<code class="function">YSorted </code>
order in that all rectangles with an equal Y origin are
nondecreasing in their X origin.
<code class="function">YXBanded </code>
additionally constrains
<code class="function">YXSorted </code>
by requiring that, for every possible Y scanline,
all rectangles that include that scanline have identical Y origins and Y
extents.
</p><p>
<code class="function">ShapeMask</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>dest</em></span>: WINDOW
<span class="emphasis"><em>destKind</em></span>: SHAPE_KIND
<span class="emphasis"><em>op</em></span>: SHAPE_OP
<span class="emphasis"><em>xOff, yOff</em></span>: INT16
<span class="emphasis"><em>source</em></span>: PIXMAP or
<code class="function">None</code>
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window</code>,
<code class="function">Pixmap</code>,
<code class="function">Match</code>,
<code class="function">Value</code>
      </td></tr></tbody></table></div><p>
The source in this request is a 1-bit deep pixmap, or
<code class="function">None .</code>
If source is
<code class="function">None ,</code>
the specified client region is removed from the window, causing the effective
region to revert to the default region.  The
<code class="function">ShapeNotify</code>
event generated by this request and subsequent
<code class="function">ShapeQueryExtents</code>
will report that a client shape has not been specified.
If a valid pixmap is specified, it is converted
to a region, with bits set to one included in the region and bits set to
zero excluded, and an offset from the window origin as specified by
xOff and yOff.  The resulting region is then combined (as
specified by the operator op) with the existing client region
(indicated by destKind) of the destination window, and the result is
stored as the specified client region of the destination window.  The source
pixmap and destination window must have been created on the same screen,
or else a
<code class="function">Match</code>
error results.
</p><p>
<code class="function">ShapeCombine</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>dest</em></span>: WINDOW
      </td></tr><tr><td align="left">
<span class="emphasis"><em>destKind</em></span>: SHAPE_KIND
      </td></tr><tr><td align="left">
<span class="emphasis"><em>op</em></span>: SHAPE_OP
      </td></tr><tr><td align="left">
<span class="emphasis"><em>xOff, yOff</em></span>: INT16
      </td></tr><tr><td align="left">
<span class="emphasis"><em>source</em></span>: WINDOW
      </td></tr><tr><td align="left">
<span class="emphasis"><em>sourceKind</em></span>: SHAPE_KIND
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window</code>,
<code class="function">Match</code>,
<code class="function">Value</code>
      </td></tr></tbody></table></div><p>
The client region, indicated by sourceKind, of the source window is
offset from the window origin by xOff and yOff and combined with
the client region, indicated by destKind, of the destination window.
The result is stored as the specified client region of the destination
window.
The source and destination windows must be on the same screen, or else a
<code class="function">Match</code>
error results.
</p><p>
<code class="function">ShapeOffset</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>dest</em></span>: WINDOW
      </td></tr><tr><td align="left">
<span class="emphasis"><em>destKind</em></span>: SHAPE_KIND
      </td></tr><tr><td align="left">
<span class="emphasis"><em>xOff, yOff</em></span>: INT16
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window</code>,
<code class="function">Match</code>,
<code class="function">Value</code>
      </td></tr></tbody></table></div><p>
The client region, indicated by destKind, is moved relative to its
current position by the amounts xOff and yOff.
</p><p>
<code class="function">ShapeQueryExtents</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>dest</em></span>: WINDOW
      </td></tr></tbody></table></div><p>
   =&gt;
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
boundingShaped: BOOL
      </td></tr><tr><td align="left">
clipShaped: BOOL
      </td></tr><tr><td align="left">
xBoundingShape: INT16
      </td></tr><tr><td align="left">
yBoundingShape: INT16
      </td></tr><tr><td align="left">
widthBoundingShape: CARD16
      </td></tr><tr><td align="left">
heightBoundingShape: CARD16
      </td></tr><tr><td align="left">
xClipShape: INT16
      </td></tr><tr><td align="left">
yClipShape: INT16
      </td></tr><tr><td align="left">
widthClipShape: CARD16
      </td></tr><tr><td align="left">
heightClipShape: CARD16
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window</code>
      </td></tr></tbody></table></div><p>
The boundingShaped and clipShaped results are
<code class="function">True</code>
if the corresponding client regions have been specified, else they are
<code class="function">False .</code>
The x, y, width, and height values define the extents of the client regions,
when a client region has not been specified, the extents of the
corresponding default region are reported.
</p><p>
<code class="function">ShapeSelectInput</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>window</em></span>: WINDOW
      </td></tr><tr><td align="left">
<span class="emphasis"><em>enable</em></span>: BOOL
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window</code>,
<code class="function">Value</code>
      </td></tr></tbody></table></div><p>
Specifying enable as
<code class="function">True</code>
causes the server to send the requesting client a
<code class="function">ShapeNotify</code>
event whenever the bounding, clip or input region of the specified window is
altered by any client.
Specifying enable as
<code class="function">False</code>
causes the server to stop sending such events.
</p><p>
<code class="function">ShapeInputSelected</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>window</em></span>: WINDOW
      </td></tr><tr><td align="left">
=&gt;
enable: BOOL
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window</code>
      </td></tr></tbody></table></div><p>
If enable is
<code class="function">True</code>, then
<code class="function">ShapeNotify</code>
events for the window are generated for this client.
</p><p>
<code class="function">ShapeGetRectangles</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>window</em></span>: WINDOW
      </td></tr><tr><td align="left">
<span class="emphasis"><em>kind</em></span>: SHAPE_KIND
      </td></tr><tr><td align="left">
   =&gt;
rectangles: LISTofRECTANGLE
      </td></tr><tr><td align="left">
ordering:
{ <code class="function">UnSorted</code>,
<code class="function">YSorted</code>,
<code class="function">YXSorted</code>,
<code class="function">YXBanded</code> }
      </td></tr><tr><td align="left">
Errors:
<code class="function">Window,</code>
<code class="function">Match</code>
      </td></tr></tbody></table></div><p>
A list of rectangles describing the region indicated by kind, and the
ordering of those rectangles, is returned.  The meaning of the ordering
values is the same as in the
<code class="function">ShapeRectangles</code>
request.
</p></div><div class="chapter" title="Chapter 5. Events"><div class="titlepage"><div><div><h2 class="title"><a id="Events"></a>Chapter 5. Events</h2></div></div></div><p>
<code class="function">ShapeNotify</code>
</p><div class="informaltable"><table border="0"><colgroup><col align="left" class="c1" /></colgroup><tbody><tr><td align="left">
<span class="emphasis"><em>window</em></span>: WINDOW
      </td></tr><tr><td align="left">
<span class="emphasis"><em>kind</em></span>: SHAPE_KIND
      </td></tr><tr><td align="left">
<span class="emphasis"><em>shaped</em></span>: BOOL
      </td></tr><tr><td align="left">
<span class="emphasis"><em>x, y</em></span>: INT16
      </td></tr><tr><td align="left">
<span class="emphasis"><em>width</em></span>,
<span class="emphasis"><em>height</em></span>: CARD16
      </td></tr><tr><td align="left">
<span class="emphasis"><em>time</em></span>: TIMESTAMP
      </td></tr></tbody></table></div><p>
Whenever the client bounding, clip or input shape of a window is modified, a
<code class="function">ShapeNotify</code>
event is sent to each client that has used
<code class="function">ShapeSelectInput</code>
to request it.
</p><p>
Kind indicates which client region (bounding or clip) has been modified;
shaped is
<code class="function">True</code>
when the window has a client shape of type kind, and is
<code class="function">False</code>
when the window no longer has a client shape of this type.
The x, y, width, and height indicate the extents of the
current shape.  When shaped is
<code class="function">False</code>
these will indicate the extents of the default region.  The timestamp
indicates the server time when the shape was changed.
</p></div><div class="chapter" title="Chapter 6. Encoding"><div class="titlepage"><div><div><h2 class="title"><a id="Encoding"></a>Chapter 6. Encoding</h2></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="sect1"><a href="#New_Types">New Types</a></span></dt><dt><span class="sect1"><a href="#Requests_2">Requests</a></span></dt><dt><span class="sect1"><a href="#Events_2">Events</a></span></dt></dl></div><p>
Please refer to the X11 Protocol Encoding document as this document uses
conventions established there.
</p><p>
The name of this extension is "SHAPE".
</p><div class="sect1" title="New Types"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="New_Types"></a>New Types</h2></div></div></div><pre class="literallayout">
SHAPE_KIND
     0     Bounding
     1     Clip
     2     Input
</pre><pre class="literallayout">
SHAPE_OP
     0     Set
     1     Union
     2     Intersect
     3     Subtract
     4     Invert
</pre></div><div class="sect1" title="Requests"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="Requests_2"></a>Requests</h2></div></div></div><pre class="literallayout">
<code class="function">ShapeQueryVersion</code>
     1     CARD8              opcode
     1     0                  shape opcode
     2     1                  request length

=&gt;
     1     1                  Reply
     1                        unused
     2     CARD16             sequence number
     4     0                  length
     2     CARD16             major version
     2     CARD16             minor version
     20                       unused
</pre><pre class="literallayout">
<code class="function">ShapeRectangles</code>
     1     CARD8              opcode
     1     1                  shape opcode
     2     4+2n               request length
     1     SHAPE_OP           operation
     1     SHAPE_KIND         destination kind
     1                        ordering
           0     UnSorted
           1     YSorted
           2     YXSorted
           3     YXBanded
     1                        unused
     4     WINDOW             destination window
     2     INT16              x offset
     2     INT16              y offset
     8n    LISTofRECTANGLE    rectangles
</pre><pre class="literallayout">
<code class="function">ShapeMask</code>
     1     CARD8              opcode
     1     2                  shape opcode
     2     5                  request length
     1     SHAPE_OP           operation
     1     SHAPE_KIND         destination kind
     2                        unused
     4     WINDOW             destination window
     2     INT16              x offset
     2     INT16              y offset
     4     PIXMAP             source bitmap
           0     None
</pre><pre class="literallayout">
<code class="function">ShapeCombine</code>
     1     CARD8              opcode
     1     3                  shape opcode
     2     5                  request length
     1     SHAPE_OP           operation
     1     SHAPE_KIND         destination kind
     1     SHAPE_KIND         source kind
     1                        unused
     4     WINDOW             destination window
     2     INT16              x offset
     2     INT16              y offset
     4     WINDOW             source window
</pre><pre class="literallayout">
<code class="function">ShapeOffset</code>
     1     CARD8              opcode
     1     4                  shape opcode
     2     4                  request length
     1     SHAPE_KIND         destination kind
     3                        unused
     4     WINDOW             destination window
     2     INT16              x offset
     2     INT16              y offset
</pre><pre class="literallayout">
<code class="function">ShapeQueryExtents</code>
     1     CARD8              opcode
     1     5                  shape opcode
     2     2                  request length
     4     WINDOW             destination window

 =&gt;
     1     1                  Reply
     1                        unused
     2     CARD16             sequence number
     4     0                  reply length
     1     BOOL               bounding shaped
     1     BOOL               clip shaped
     2                        unused
     2     INT16              bounding shape extents x
     2     INT16              bounding shape extents y
     2     CARD16             bounding shape extents width
     2     CARD16             bounding shape extents height
     2     INT16              clip shape extents x
     2     INT16              clip shape extents y
     2     CARD16             clip shape extents width
     2     CARD16             clip shape extents height
     4                        unused
</pre><pre class="literallayout">
<code class="function">ShapeSelectInput</code>
     1     CARD8              opcode
     1     6                  shape opcode
     2     3                  request length
     4     WINDOW             destination window
     1     BOOL               enable
     3                        unused
</pre><pre class="literallayout">
<code class="function">ShapeInputSelected</code>
     1     CARD8              opcode
     1     7                  shape opcode
     2     2                  request length
     4     WINDOW             destination window
 =&gt;
     1     1                  Reply
     1     BOOL               enabled
     2     CARD16             sequence number
     4     0                  reply length
     24                       unused
</pre><pre class="literallayout">
<code class="function">ShapeGetRectangles</code>
     1     CARD8              opcode
     1     8                  shape opcode
     2     3                  request length
     4     WINDOW             window
     1     SHAPE_KIND         source kind
     3                        unused
 =&gt;
     1     1                  Reply
     1                        ordering
           0     UnSorted
           1     YSorted
           2     YXSorted
           3     YXBanded
     2     CARD16             sequence number
     4     2n                 reply length
     4     CARD32             nrects
     20                       unused
     8n    LISTofRECTANGLE    rectangles
</pre></div><div class="sect1" title="Events"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="Events_2"></a>Events</h2></div></div></div><pre class="literallayout">
<code class="function">ShapeNotify</code>
     1     CARD8               type (0 + extension event base)
     1     SHAPE_KIND          shape kind
     2     CARD16              sequence number
     4     WINDOW              affected window
     2     INT16               x value of extents
     2     INT16               y value of extents
     2     CARD16              width of extents
     2     CARD16              height of extents
     4     TIMESTAMP           server time
     1     BOOL                shaped
     11                        unused
</pre></div></div><div class="glossary" title="Glossary"><div class="titlepage"><div><div><h2 class="title"><a id="glossary"></a>Glossary</h2></div></div></div><dl><dt>bounding region</dt><dd><p>
The area of the parent window that this window will occupy.  This area is
divided into two parts:  the border and the interior.

    </p></dd><dt>clip region</dt><dd><p>
The interior of the window, as a subset of the bounding region.  This
region describes the area that will be painted with the window background
when the window is cleared, will contain all graphics output to the window,
and will clip any subwindows.

    </p></dd><dt>input region</dt><dd><p>
The subset of the bounding region which can ``contain'' the
pointer.

    </p></dd><dt>default bounding region</dt><dd><p>
The rectangular area, as described by the core protocol window size, that
covers the interior of the window and its border.

    </p></dd><dt>default clip region</dt><dd><p>
The rectangular area, as described by the core protocol window size, that
covers the interior of the window and excludes the border.

    </p></dd><dt>default input region</dt><dd><p>
The rectangular area, as described by the core protocol window size, that
covers the interior of the window and its border.

    </p></dd><dt>client bounding region</dt><dd><p>
The region associated with a window that is directly modified via this
extension when specified by
<code class="function"> ShapeBounding .</code>
This region is used in conjunction with the default bounding region
to produce the effective bounding region.

    </p></dd><dt>client clip region</dt><dd><p>
The region associated with a window that is directly modified via this
extension when specified by
<code class="function"> ShapeClip . </code>
This region is used in conjunction with the default clip region
and the client bounding region to produce the effective clip region.

    </p></dd><dt>client input region</dt><dd><p>
The region associated with a window that is directly modified via this
extension when specified by
<code class="function"> ShapeInput . </code>
This region is used in conjunction with the default input region
and the client bounding region to produce the effective input region.

    </p></dd><dt>effective bounding region</dt><dd><p>
The actual shape of the window on the screen, including border and interior
(but excluding the effects of overlapping windows).  When a window has a client
bounding region, the effective bounding region is the intersection of the
default bounding region and the client bounding region.  Otherwise, the
effective bounding region is the same as the default bounding region.

    </p></dd><dt>effective clip region</dt><dd><p>
The actual shape of the interior of the window on the screen (excluding the
effects of overlapping windows).  When a window has a client clip region or
a client bounding region, the effective clip region is the intersection of
the default clip region, the client clip region (if any) and the client
bounding region (if any).  Otherwise, the effective clip region is the
same as the default clip region.

    </p></dd><dt>effective input region</dt><dd><p>
The actual shape of the window on the screen (excluding the
effects of overlapping windows) which can ``contain'' the pointer.
When a window has a client input region or
a client bounding region, the effective input region is the intersection of
the default input region, the client input region (if any) and the client
bounding region (if any).  Otherwise, the effective input region is the
same as the default input region.

    </p></dd></dl></div></div></body></html>
